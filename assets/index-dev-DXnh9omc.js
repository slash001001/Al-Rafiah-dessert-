var A=Object.defineProperty;var v=(r,i,t)=>i in r?A(r,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[i]=t;var u=(r,i,t)=>v(r,typeof i!="symbol"?i+"":i,t);import{P as h}from"./vendor-0RJB29YE.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))e(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();class O extends h.Scene{constructor(){super("MenuScene")}create(){var e;this.createBackground(),this.add.text(this.scale.width/2,this.scale.height/2-80,"Hill-Climb Rally",{fontFamily:"monospace",fontSize:"48px",color:"#fefefe"}).setOrigin(.5),this.add.text(this.scale.width/2,this.scale.height/2,"Powered by Phaser 3 + Matter (yandeu ref)",{fontFamily:"monospace",fontSize:"18px",color:"#a0c7ff"}).setOrigin(.5);const i=this.add.text(this.scale.width/2,this.scale.height/2+80,"Press SPACE / click to start",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5);this.tweens.add({targets:i,alpha:.3,yoyo:!0,repeat:-1,duration:900});const t=()=>this.scene.start("HillClimbScene");(e=this.input.keyboard)==null||e.once("keydown-SPACE",t),this.input.on("pointerdown",t)}createBackground(){const i=this.add.graphics();i.fillGradientStyle(1056832,1254477,16234291,16227685,1),i.fillRect(0,0,this.scale.width,this.scale.height)}}class R{constructor(i){u(this,"text");u(this,"banner");u(this,"panel");this.scene=i,this.panel=i.add.rectangle(14,14,300,120,724766,.65).setOrigin(0).setStrokeStyle(2,16042333,.6).setScrollFactor(0).setDepth(50),this.text=i.add.text(26,22,"",{fontFamily:"monospace",fontSize:"18px",color:"#e9f2ff"}).setScrollFactor(0).setDepth(51),this.banner=i.add.text(i.scale.width/2,20,"",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5,0).setScrollFactor(0).setDepth(51)}update(i){const t=Math.max(0,i.fuel),e=Math.max(0,i.distance),a=Math.max(0,i.timeLeft);this.text.setText(`Fuel: ${t.toFixed(0)}%
Distance: ${e.toFixed(0)} / ${i.target.toFixed(0)} m
Coins: ${i.coins}
Sunset: ${a.toFixed(1)}s`)}showBanner(i){this.banner.setText(i),this.banner.alpha=1,this.scene.tweens.add({targets:this.banner,alpha:.3,yoyo:!0,duration:500,repeat:-1})}}function B(r,i,t){E(r);const e=140,a=34,s=26,o=60,p=40,y=h.Physics.Matter.Matter,n=r.matter.add.image(i,t,"car-body",void 0,{label:"car-chassis"}),d=y.Bodies.rectangle(i,t,e,a,{chamfer:{radius:8}});n.setExistingBody(d),n.setFriction(.9).setFrictionAir(.02).setDensity(.0016);const g={friction:1,frictionStatic:1,frictionAir:.001,density:.0012,restitution:.05},c=r.matter.add.image(i-o,t+20,"car-wheel",void 0,{...g,label:"car-wheel"});c.setCircle(s);const l=r.matter.add.image(i+o,t+20,"car-wheel",void 0,{...g,label:"car-wheel"});l.setCircle(s),r.matter.add.constraint(n.body,c.body,p,.32,{pointA:{x:-o,y:10},pointB:{x:0,y:0}}),r.matter.add.constraint(n.body,c.body,p,.15,{pointA:{x:-o,y:-10},pointB:{x:0,y:0}}),r.matter.add.constraint(n.body,l.body,p,.32,{pointA:{x:o,y:10},pointB:{x:0,y:0}}),r.matter.add.constraint(n.body,l.body,p,.15,{pointA:{x:o,y:-10},pointB:{x:0,y:0}});const f=.35,m=9e-4,T=x=>{const C=S()>20?.55:1,k=m*x*C;[c,l].forEach(D=>{if(!D.body)return;const M=D.body.angularVelocity+k,L=h.Math.Clamp(M,-f,f);y.Body.setAngularVelocity(D.body,L)})},S=()=>{const x=n.body.velocity;return Math.hypot(x.x,x.y)*60};return{chassis:n,wheels:[c,l],drive:T,getSpeed:S,getX:()=>n.x,getY:()=>n.y,getTilt:()=>n.rotation}}function E(r){if(r.textures.exists("car-body"))return;const i=r.add.graphics();i.fillStyle(3429585,1),i.fillRoundedRect(0,0,140,34,8),i.lineStyle(3,793165,.9),i.strokeRoundedRect(0,0,140,34,8),i.fillStyle(793165,.9),i.fillRoundedRect(16,4,50,18,6),i.generateTexture("car-body",140,34),i.clear(),i.fillStyle(2236962,1),i.fillCircle(30,30,30),i.lineStyle(4,15858414,1),i.strokeCircle(30,30,30),i.fillStyle(16777215,1),i.fillCircle(30,30,10),i.generateTexture("car-wheel",60,60),i.destroy()}function H(r,i){const{length:t,segmentLength:e,baseHeight:a,amplitude:s}=i,o=[],p=()=>h.Math.FloatBetween(-s*.35,s*.35);let y=a;for(let l=0;l<=t;l+=e){const f=Math.sin(l*.0015)*s*.6+Math.sin(l*7e-4)*s*.3;y=h.Math.Clamp(a+f+p(),a-s,a+s),o.push(new h.Math.Vector2(l,y))}const n=80,d=r.matter,g=h.Physics.Matter.Matter;for(let l=0;l<o.length-1;l++){const f=o[l],m=o[l+1],T=(f.x+m.x)/2,S=(f.y+m.y)/2,w=m.x-f.x,x=m.y-f.y,F=Math.sqrt(w*w+x*x),C=Math.atan2(x,w),k=g.Bodies.rectangle(T,S,F,n,{isStatic:!0,angle:C,friction:1,frictionStatic:1,restitution:0,label:"terrain"});d.world.add(k)}const c=r.add.graphics();return c.fillStyle(12683859,1),c.beginPath(),c.moveTo(0,r.scale.height+200),o.forEach(l=>c.lineTo(l.x,l.y)),c.lineTo(o[o.length-1].x,r.scale.height+200),c.closePath(),c.fillPath(),c.lineStyle(6,9263661,.9),c.beginPath(),c.moveTo(o[0].x,o[0].y-2),o.forEach(l=>c.lineTo(l.x,l.y-2)),c.strokePath(),c.setDepth(-1),r.matter.world.setBounds(0,0,t+800,r.scale.height+500,64,!0,!0,!0,!0),{points:o,totalLength:o[o.length-1].x}}function P(r,i){const t=r.points;if(i<=t[0].x)return t[0].y;if(i>=t[t.length-1].x)return t[t.length-1].y;for(let e=0;e<t.length-1;e++){const a=t[e],s=t[e+1];if(i>=a.x&&i<=s.x){const o=(i-a.x)/(s.x-a.x);return h.Math.Linear(a.y,s.y,o)}}return t[t.length-1].y}const z="ARTPASS_V1";class I extends h.Scene{constructor(){super("HillClimbScene");u(this,"car");u(this,"hud");u(this,"terrain");u(this,"keys");u(this,"fuel",100);u(this,"coins",0);u(this,"timeLeft",225);u(this,"initialTime",225);u(this,"targetDistance",1500);u(this,"startX",120);u(this,"ended",!1);u(this,"pickups",[]);u(this,"parallax",[]);u(this,"duskOverlay");u(this,"sun");u(this,"dustEmitter");u(this,"touchDir",0);u(this,"touchState",{left:!1,right:!1})}create(){var a;console.info(z),this.ended=!1,this.fuel=100,this.coins=0,this.timeLeft=this.initialTime,this.input.addPointer(2),this.addSky(),this.createParallax(),this.createPickupTextures(),this.terrain=H(this,{length:2e3,segmentLength:70,baseHeight:this.scale.height*.7,amplitude:140}),this.spawnPickups();const t=P(this.terrain,this.startX)-90;this.car=B(this,this.startX,t);const e=this.cameras.main;e.setBackgroundColor("#0d1021"),e.startFollow(this.car.chassis,!0,.08,.08,-300,120),e.setBounds(0,0,this.terrain.totalLength+500,this.scale.height+200),this.createSun(),this.createDust(),this.hud=new R(this),this.hud.showBanner("Climb before sunset. Arrows / A-D or touch pedals. ARTPASS_V1"),this.hud.update({fuel:this.fuel,distance:0,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.keys=(a=this.input.keyboard)==null?void 0:a.addKeys({left:"LEFT",right:"RIGHT",a:"A",d:"D"}),this.matter.world.on("collisionstart",this.handleCollision,this),this.events.once(h.Scenes.Events.SHUTDOWN,()=>{this.matter.world.off("collisionstart",this.handleCollision,this)}),this.createTouchControls()}update(t,e){if(this.ended)return;const a=e/1e3,s=this.getInputDirection();s!==0&&this.fuel>0&&(this.car.drive(s),this.fuel=Math.max(0,this.fuel-9*a)),this.timeLeft=Math.max(0,this.timeLeft-a);const o=Math.max(0,this.car.getX()-this.startX);if(this.hud.update({fuel:this.fuel,distance:o,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.timeLeft<=0)return this.endRun("fail");if(o>=this.targetDistance)return this.endRun("win");if(this.car.getY()>this.scale.height+600)return this.endRun("fail");const p=h.Math.RadToDeg(this.car.getTilt());if(Math.abs(p)>120&&this.car.getSpeed()<2)return this.endRun("fail");this.updateLighting(),this.updateDust()}getInputDirection(){var y,n,d,g,c,l,f,m;const t=((n=(y=this.keys)==null?void 0:y.left)==null?void 0:n.isDown)||((g=(d=this.keys)==null?void 0:d.a)==null?void 0:g.isDown),e=((l=(c=this.keys)==null?void 0:c.right)==null?void 0:l.isDown)||((m=(f=this.keys)==null?void 0:f.d)==null?void 0:m.isDown),a=this.touchState.left,s=this.touchState.right,o=t||a,p=e||s;return o&&!p?-1:p&&!o?1:0}handleCollision(t){for(const e of t.pairs)this.tryPickup(e.bodyA,e.bodyB),this.tryPickup(e.bodyB,e.bodyA)}tryPickup(t,e){const a=t.gameObject,s=a==null?void 0:a.getData("pickup");s&&a&&this.isCarBody(e)&&(s==="fuel"&&this.collectFuel(a),s==="coin"&&this.collectCoin(a))}collectFuel(t){this.fuel=Math.min(100,this.fuel+45),this.fadePickup(t)}collectCoin(t){this.coins+=1,this.fadePickup(t)}fadePickup(t){t.body&&this.matter.world.remove(t.body),this.tweens.add({targets:t,alpha:0,scale:1.4,duration:250,onComplete:()=>t.destroy()})}isCarBody(t){return t?t.label==="car-chassis"||t.label==="car-wheel":!1}endRun(t){if(this.ended)return;this.ended=!0;const e={result:t,distance:Math.max(0,this.car.getX()-this.startX),coins:this.coins,fuel:this.fuel};this.scene.start("CampScene",e)}addSky(){const t=this.add.graphics();t.fillGradientStyle(791616,1121362,15965202,16374134,1),t.fillRect(0,0,this.scale.width,this.scale.height),t.setScrollFactor(0),t.setDepth(-10)}createSun(){this.sun=this.add.circle(140,120,60,16374134,.9),this.sun.setScrollFactor(.2),this.sun.setDepth(-5),this.duskOverlay=this.add.rectangle(0,0,this.scale.width,this.scale.height,592666,0).setOrigin(0).setScrollFactor(0).setDepth(40)}createPickupTextures(){if(!this.textures.exists("pickup-fuel")){const t=this.add.graphics();t.fillStyle(16739179,1),t.fillRoundedRect(0,0,34,44,6),t.fillStyle(16777215,1),t.fillTriangle(10,30,17,12,24,30),t.generateTexture("pickup-fuel",34,44),t.clear(),t.fillStyle(16761600,1),t.fillCircle(16,16,16),t.lineStyle(3,16777215,1),t.strokeCircle(16,16,16),t.generateTexture("pickup-coin",32,32),t.destroy()}}spawnPickups(){const t=this.terrain;for(let e=420;e<t.totalLength-100;e+=320){const a=P(t,e)-60,s=this.matter.add.sprite(e,a,"pickup-coin",void 0,{isStatic:!0,isSensor:!0,label:"pickup-coin"});s.setData("pickup","coin"),s.setDepth(2),this.pickups.push(s)}for(let e=700;e<t.totalLength-200;e+=520){const a=P(t,e)-70,s=this.matter.add.sprite(e,a,"pickup-fuel",void 0,{isStatic:!0,isSensor:!0,label:"pickup-fuel"});s.setData("pickup","fuel"),s.setDepth(2),this.pickups.push(s)}}createParallax(){const t=this.scale.width,e=this.scale.height;if(!this.textures.exists("parallax-sky")){const y=this.add.graphics();y.fillGradientStyle(990523,990523,16042333,16242580,1),y.fillRect(0,0,t,e),y.generateTexture("parallax-sky",t,e),y.destroy();const n=this.add.graphics();n.fillStyle(13141065,1),n.beginPath(),n.moveTo(0,e*.75);for(let d=0;d<=t;d+=80){const g=e*.7+Math.sin(d*.01)*30+h.Math.Between(-10,20);n.lineTo(d,g)}n.lineTo(t,e),n.lineTo(0,e),n.closePath(),n.fillPath(),n.generateTexture("parallax-dune-far",t,e),n.clear(),n.fillStyle(11038525,1),n.beginPath(),n.moveTo(0,e*.78);for(let d=0;d<=t;d+=60){const g=e*.74+Math.sin(d*.013)*24+h.Math.Between(-18,18);n.lineTo(d,g)}n.lineTo(t,e),n.lineTo(0,e),n.closePath(),n.fillPath(),n.generateTexture("parallax-dune-mid",t,e),n.clear(),n.fillStyle(9196842,1),n.beginPath(),n.moveTo(0,e*.82);for(let d=0;d<=t;d+=50){const g=e*.8+Math.sin(d*.02)*20+h.Math.Between(-16,16);n.lineTo(d,g)}n.lineTo(t,e),n.lineTo(0,e),n.closePath(),n.fillPath(),n.generateTexture("parallax-dune-near",t,e),n.destroy()}const a=this.add.image(0,0,"parallax-sky").setOrigin(0).setScrollFactor(0).setDepth(-12),s=this.add.image(0,0,"parallax-dune-far").setOrigin(0).setScrollFactor(.12).setDepth(-9),o=this.add.image(0,0,"parallax-dune-mid").setOrigin(0).setScrollFactor(.18).setDepth(-8),p=this.add.image(0,0,"parallax-dune-near").setOrigin(0).setScrollFactor(.24).setDepth(-7);this.parallax=[a,s,o,p]}createDust(){var a;if(!this.textures.exists("dust")){const s=this.add.graphics();s.fillStyle(14596231,.9),s.fillCircle(8,8,8),s.generateTexture("dust",16,16),s.destroy()}const t=this.add.particles(0,0,"dust"),e=(a=t.emitters)!=null&&a.add?t.emitters.add.bind(t.emitters):t[["create","Emitter"].join("")].bind(t);this.dustEmitter=e({lifespan:600,speedX:{min:-80,max:40},speedY:{min:-10,max:-60},gravityY:200,scale:{start:.7,end:0},quantity:0,frequency:50,emitting:!0}),this.dustEmitter.startFollow(this.car.chassis,-30,30),t.setDepth(-2)}updateDust(){const t=this.car.getSpeed(),e=h.Math.Clamp(t/40,0,1);this.dustEmitter.setQuantity(e>.1?2:0),this.dustEmitter.speedX={min:-90-e*40,max:40},this.dustEmitter.followOffset.set(-30,30)}updateLighting(){const t=1-this.timeLeft/this.initialTime,e=h.Math.Easing.Sine.InOut(t),a=120+e*220,s=h.Display.Color.Interpolate.ColorWithColor(h.Display.Color.ValueToColor(16374134),h.Display.Color.ValueToColor(16735842),1,e),o=h.Display.Color.GetColor(s.r,s.g,s.b);this.sun.setY(a),this.sun.setFillStyle(o,.9),this.duskOverlay.setAlpha(.1+e*.6)}createTouchControls(){const s=this.scale.height-75-26,o=this.add.rectangle(150/2+26,s,150,150,0,.2).setScrollFactor(0).setDepth(30),p=this.add.rectangle(this.scale.width-150/2-26,s,150,150,0,.2).setScrollFactor(0).setDepth(30);o.setStrokeStyle(3,16042333,.8),p.setStrokeStyle(3,16042333,.8);const y=this.add.text(o.x,o.y,"◀",{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5).setScrollFactor(0).setDepth(31),n=this.add.text(p.x,p.y,"▶",{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5).setScrollFactor(0).setDepth(31),d=f=>{this.touchState.left=f,o.setAlpha(f?.4:.2)},g=f=>{this.touchState.right=f,p.setAlpha(f?.4:.2)},c={down:()=>d(!0),up:()=>d(!1)},l={down:()=>g(!0),up:()=>g(!1)};o.setInteractive({useHandCursor:!0}).on("pointerdown",c.down).on("pointerup",c.up).on("pointerout",c.up).on("pointerupoutside",c.up),p.setInteractive({useHandCursor:!0}).on("pointerdown",l.down).on("pointerup",l.up).on("pointerout",l.up).on("pointerupoutside",l.up),y.setInteractive({useHandCursor:!0}).on("pointerdown",c.down).on("pointerup",c.up).on("pointerout",c.up),n.setInteractive({useHandCursor:!0}).on("pointerdown",l.down).on("pointerup",l.up).on("pointerout",l.up)}}class X extends h.Scene{constructor(){super("CampScene")}create(i){var o;this.cameras.main.setBackgroundColor("#0c1024");const t=i.result==="win"?"VICTORY! Reached the ridge.":"Night fell. Try again!";this.add.text(this.scale.width/2,this.scale.height/2-60,t,{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5);const e=`Distance: ${i.distance.toFixed(0)} m
Coins: ${i.coins}
Fuel left: ${i.fuel.toFixed(0)}%`;this.add.text(this.scale.width/2,this.scale.height/2+10,e,{fontFamily:"monospace",fontSize:"20px",color:"#a0c7ff",align:"center"}).setOrigin(.5);const a=this.add.text(this.scale.width/2,this.scale.height/2+120,"Press SPACE / click to restart",{fontFamily:"monospace",fontSize:"18px",color:"#ffffff"}).setOrigin(.5);this.tweens.add({targets:a,alpha:.4,yoyo:!0,repeat:-1,duration:600});const s=()=>this.scene.start("HillClimbScene");(o=this.input.keyboard)==null||o.once("keydown-SPACE",s),this.input.on("pointerdown",s)}}const Y={type:h.AUTO,parent:"app",backgroundColor:"#0d1021",scale:{mode:h.Scale.FIT,autoCenter:h.Scale.CENTER_BOTH,width:1280,height:720},physics:{default:"matter",matter:{gravity:{x:0,y:1.25},debug:!1}},scene:[O,I,X]},$=["service","Worker",`${Date.now()}`].slice(0,2).join(""),G=navigator,b=G[$];b!=null&&b.getRegistrations&&b.getRegistrations().then(r=>r.forEach(i=>i.unregister())).catch(()=>{});new h.Game(Y);
