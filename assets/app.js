var B=Object.defineProperty;var E=(l,e,t)=>e in l?B(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var h=(l,e,t)=>E(l,typeof e!="symbol"?e+"":e,t);import{P as c}from"./vendor-0RJB29YE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();class H extends c.Scene{constructor(){super("MenuScene")}create(){var i;this.createBackground(),this.add.text(this.scale.width/2,this.scale.height/2-80,"Hill-Climb Rally",{fontFamily:"monospace",fontSize:"48px",color:"#fefefe"}).setOrigin(.5),this.add.text(this.scale.width/2,this.scale.height/2,"Powered by Phaser 3 + Matter (yandeu ref)",{fontFamily:"monospace",fontSize:"18px",color:"#a0c7ff"}).setOrigin(.5);const e=this.add.text(this.scale.width/2,this.scale.height/2+80,"Press SPACE / click to start",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5);this.tweens.add({targets:e,alpha:.3,yoyo:!0,repeat:-1,duration:900});const t=()=>this.scene.start("HillClimbScene");(i=this.input.keyboard)==null||i.once("keydown-SPACE",t),this.input.on("pointerdown",t)}createBackground(){const e=this.add.graphics();e.fillGradientStyle(1056832,1254477,16234291,16227685,1),e.fillRect(0,0,this.scale.width,this.scale.height)}}class X{constructor(e){h(this,"text");h(this,"banner");h(this,"panel");h(this,"rightPanel");h(this,"rightText");this.scene=e,this.panel=e.add.rectangle(14,14,300,120,724766,.65).setOrigin(0).setStrokeStyle(2,16042333,.6).setScrollFactor(0).setDepth(50),this.text=e.add.text(26,22,"",{fontFamily:"monospace",fontSize:"18px",color:"#e9f2ff"}).setScrollFactor(0).setDepth(51),this.rightPanel=e.add.rectangle(e.scale.width-200,14,186,64,724766,.65).setOrigin(0).setStrokeStyle(2,16765286,.6).setScrollFactor(0).setDepth(50),this.rightText=e.add.text(e.scale.width-190,22,"",{fontFamily:"monospace",fontSize:"16px",color:"#ffdf9e"}).setScrollFactor(0).setDepth(51),this.banner=e.add.text(e.scale.width/2,20,"",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5,0).setScrollFactor(0).setDepth(51)}update(e){const t=Math.max(0,e.fuel),i=Math.max(0,e.distance),s=Math.max(0,e.timeLeft);this.text.setText(`Fuel: ${t.toFixed(0)}%
Distance: ${i.toFixed(0)} / ${e.target.toFixed(0)} m
Coins: ${e.coins}
Night in: ${s.toFixed(1)}s`),this.rightText.setText(`ARTPASS_FUN_V1
PLAY: ◀ / ▶ or touch pedals`)}showBanner(e){this.banner.setText(e),this.banner.alpha=1,this.scene.tweens.add({targets:this.banner,alpha:.3,yoyo:!0,duration:500,repeat:-1})}}function I(l,e,t){Z(l);const i=140,s=36,a=26,o=64,g=44,p=c.Physics.Matter.Matter,r=l.matter.add.image(e,t,"car-body",void 0,{label:"car-chassis"}),d=p.Bodies.rectangle(e,t,i,s,{chamfer:{radius:8}});r.setExistingBody(d),r.setFriction(.9).setFrictionAir(.015).setDensity(.0014);const y={friction:1.05,frictionStatic:1.2,frictionAir:8e-4,density:.0013,restitution:.04},u=l.matter.add.image(e-o,t+20,"car-wheel",void 0,{...y,label:"car-wheel"});u.setCircle(a);const n=l.matter.add.image(e+o,t+20,"car-wheel",void 0,{...y,label:"car-wheel"});n.setCircle(a),l.matter.add.constraint(r.body,u.body,g,.32,{pointA:{x:-o,y:10},pointB:{x:0,y:0}}),l.matter.add.constraint(r.body,u.body,g,.15,{pointA:{x:-o,y:-10},pointB:{x:0,y:0}}),l.matter.add.constraint(r.body,n.body,g,.32,{pointA:{x:o,y:10},pointB:{x:0,y:0}}),l.matter.add.constraint(r.body,n.body,g,.15,{pointA:{x:o,y:-10},pointB:{x:0,y:0}});const f=1.05,m=.22,x=.1,P=.28;return{chassis:r,wheels:[u,n],drive:S=>{const D=S*f;[u,n].forEach(A=>{if(!A.body)return;const M=A.body,L=M.angularVelocity,v=S===0?x:S<0?P:m,O=c.Math.Linear(L,D,v),R=c.Math.Clamp(O,-f,f);p.Body.setAngularVelocity(M,R)})},getSpeed:()=>{const S=r.body.velocity;return Math.hypot(S.x,S.y)*60},getX:()=>r.x,getY:()=>r.y,getTilt:()=>r.rotation}}function Z(l){if(l.textures.exists("car-body"))return;const e=l.add.graphics();e.fillStyle(3429585,1),e.fillRoundedRect(0,0,140,34,8),e.lineStyle(3,793165,.9),e.strokeRoundedRect(0,0,140,34,8),e.fillStyle(793165,.9),e.fillRoundedRect(16,4,50,18,6),e.generateTexture("car-body",140,34),e.clear(),e.fillStyle(2236962,1),e.fillCircle(30,30,30),e.lineStyle(4,15858414,1),e.strokeCircle(30,30,30),e.fillStyle(16777215,1),e.fillCircle(30,30,10),e.generateTexture("car-wheel",60,60),e.destroy()}function V(l,e){const{length:t,segmentLength:i,baseHeight:s,amplitude:a}=e,o=[],g=()=>c.Math.FloatBetween(-a*.35,a*.35);let p=s;for(let n=0;n<=t;n+=i){if(n<380){p=s-12+Math.sin(n*.002)*6,o.push(new c.Math.Vector2(n,p));continue}const f=c.Math.Clamp((n-320)/900,0,1),m=a*(.4+.6*f),x=Math.sin(n*.0014)*m*.6+Math.sin(n*65e-5)*m*.35;p=c.Math.Clamp(s+x+g()*f,s-m,s+m),o.push(new c.Math.Vector2(n,p))}for(let n=1;n<o.length-1;n++){const f=o[n-1].y,m=o[n].y,x=o[n+1].y;o[n].y=f*.25+m*.5+x*.25}const r=80,d=l.matter,y=c.Physics.Matter.Matter;for(let n=0;n<o.length-1;n++){const f=o[n],m=o[n+1],x=(f.x+m.x)/2,P=(f.y+m.y)/2,k=m.x-f.x,T=m.y-f.y,F=Math.sqrt(k*k+T*T),S=Math.atan2(T,k),D=y.Bodies.rectangle(x,P,F,r,{isStatic:!0,angle:S,friction:1,frictionStatic:1,restitution:0,label:"terrain"});d.world.add(D)}const u=l.add.graphics();return u.fillStyle(12683859,1),u.beginPath(),u.moveTo(0,l.scale.height+200),o.forEach(n=>u.lineTo(n.x,n.y)),u.lineTo(o[o.length-1].x,l.scale.height+200),u.closePath(),u.fillPath(),u.lineStyle(6,9263661,.9),u.beginPath(),u.moveTo(o[0].x,o[0].y-2),o.forEach(n=>u.lineTo(n.x,n.y-2)),u.strokePath(),u.setDepth(-1),l.matter.world.setBounds(0,0,t+800,l.scale.height+500,64,!0,!0,!0,!0),{points:o,totalLength:o[o.length-1].x}}function w(l,e){const t=l.points;if(e<=t[0].x)return t[0].y;if(e>=t[t.length-1].x)return t[t.length-1].y;for(let i=0;i<t.length-1;i++){const s=t[i],a=t[i+1];if(e>=s.x&&e<=a.x){const o=(e-s.x)/(a.x-s.x);return c.Math.Linear(s.y,a.y,o)}}return t[t.length-1].y}class Y{constructor(e){h(this,"leftZone");h(this,"rightZone");h(this,"pointers",[]);this.scene=e;const t=160,i=24,s=e.scale.height-t/2-i;this.leftZone=e.add.rectangle(t/2+i,s,t,t,0,.2).setOrigin(.5).setScrollFactor(0).setDepth(30).setStrokeStyle(3,16042333,.7).setInteractive({draggable:!1,useHandCursor:!0}),this.rightZone=e.add.rectangle(e.scale.width-t/2-i,s,t,t,0,.2).setOrigin(.5).setScrollFactor(0).setDepth(30).setStrokeStyle(3,16042333,.7).setInteractive({draggable:!1,useHandCursor:!0});const a=(r,d)=>e.add.text(r.x,r.y,d,{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5).setScrollFactor(0).setDepth(31).setInteractive({useHandCursor:!0}),o=a(this.leftZone,"◀"),g=a(this.rightZone,"▶"),p=(r,d,y)=>{const u=f=>this.press(d,f),n=f=>this.release(f);r.on("pointerdown",u),r.on("pointerup",n),r.on("pointerupoutside",n),r.on("pointerout",n),y.on("pointerdown",u),y.on("pointerup",n),y.on("pointerupoutside",n),y.on("pointerout",n)};p(this.leftZone,"left",o),p(this.rightZone,"right",g)}press(e,t){this.pointers.find(i=>i.id===t.id)||(this.pointers.push({id:t.id,side:e}),this.setZoneAlpha(e,.45))}release(e){const t=this.pointers.length;this.pointers=this.pointers.filter(i=>i.id!==e.id),t!==this.pointers.length&&(this.setZoneAlpha("left",this.isActive("left")?.45:.2),this.setZoneAlpha("right",this.isActive("right")?.45:.2))}setZoneAlpha(e,t){(e==="left"?this.leftZone:this.rightZone).setAlpha(t)}isActive(e){return this.pointers.some(t=>t.side===e)}getInput(){return{brake:this.isActive("left"),throttle:this.isActive("right")}}}const N="ARTPASS_FUN_V1";class _ extends c.Scene{constructor(){super("HillClimbScene");h(this,"car");h(this,"hud");h(this,"terrain");h(this,"keys");h(this,"fuel",100);h(this,"coins",0);h(this,"timeLeft",225);h(this,"initialTime",225);h(this,"targetDistance",1500);h(this,"startX",120);h(this,"ended",!1);h(this,"pickups",[]);h(this,"parallax",[]);h(this,"duskOverlay");h(this,"sun");h(this,"dustEmitter");h(this,"pedals");h(this,"checkpoint",{x:this.startX,y:0});h(this,"stars")}create(){var s;console.info(N),this.ended=!1,this.fuel=100,this.coins=0,this.timeLeft=this.initialTime,this.input.addPointer(2),this.addSky(),this.createStarfield(),this.createParallax(),this.createPickupTextures(),this.terrain=V(this,{length:2e3,segmentLength:70,baseHeight:this.scale.height*.7,amplitude:140}),this.spawnPickups();const t=w(this.terrain,this.startX)-90;this.car=I(this,this.startX,t),this.checkpoint={x:this.startX,y:t};const i=this.cameras.main;i.setBackgroundColor("#0d1021"),i.startFollow(this.car.chassis,!0,.08,.08,-300,120),i.setBounds(0,0,this.terrain.totalLength+500,this.scale.height+200),this.createSun(),this.createDust(),this.hud=new X(this),this.hud.showBanner("Climb before sunset. Arrows / A-D or touch pedals. ARTPASS_FUN_V1"),this.hud.update({fuel:this.fuel,distance:0,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.keys=(s=this.input.keyboard)==null?void 0:s.addKeys({left:"LEFT",right:"RIGHT",a:"A",d:"D",r:"R"}),this.matter.world.on("collisionstart",this.handleCollision,this),this.events.once(c.Scenes.Events.SHUTDOWN,()=>{this.matter.world.off("collisionstart",this.handleCollision,this)}),this.pedals=new Y(this)}update(t,i){var p;if(this.ended)return;const s=i/1e3;let a=this.getInputDirection();a===0&&this.fuel>0&&(a=.25),a!==0&&this.fuel>0&&(this.car.drive(a),this.fuel=Math.max(0,this.fuel-9*s)),this.timeLeft=Math.max(0,this.timeLeft-s);const o=Math.max(0,this.car.getX()-this.startX);if(this.hud.update({fuel:this.fuel,distance:o,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.timeLeft<=0)return this.endRun("fail");if(o>=this.targetDistance)return this.endRun("win");if(this.car.getY()>this.scale.height+800)return this.endRun("fail");const g=c.Math.RadToDeg(this.car.getTilt());if(Math.abs(g)>120&&this.car.getSpeed()<2)return this.endRun("fail");this.updateLighting(),this.updateDust(),this.captureCheckpoint(),c.Input.Keyboard.JustDown((p=this.keys)==null?void 0:p.r)&&this.respawnAtCheckpoint()}getInputDirection(){var r,d,y,u,n,f,m,x;const t=((d=(r=this.keys)==null?void 0:r.left)==null?void 0:d.isDown)||((u=(y=this.keys)==null?void 0:y.a)==null?void 0:u.isDown),i=((f=(n=this.keys)==null?void 0:n.right)==null?void 0:f.isDown)||((x=(m=this.keys)==null?void 0:m.d)==null?void 0:x.isDown),s=this.pedals.getInput(),a=s.brake,o=s.throttle,g=t||a,p=i||o;return g&&!p?-1:p&&!g?1:0}handleCollision(t){for(const i of t.pairs)this.tryPickup(i.bodyA,i.bodyB),this.tryPickup(i.bodyB,i.bodyA)}tryPickup(t,i){const s=t.gameObject,a=s==null?void 0:s.getData("pickup");a&&s&&this.isCarBody(i)&&(a==="fuel"&&this.collectFuel(s),a==="coin"&&this.collectCoin(s))}collectFuel(t){this.fuel=Math.min(100,this.fuel+45),this.fadePickup(t)}collectCoin(t){this.coins+=1,this.fadePickup(t)}fadePickup(t){t.body&&this.matter.world.remove(t.body),this.tweens.add({targets:t,alpha:0,scale:1.4,duration:250,onComplete:()=>t.destroy()})}isCarBody(t){return t?t.label==="car-chassis"||t.label==="car-wheel":!1}endRun(t){if(this.ended)return;this.ended=!0;const i={result:t,distance:Math.max(0,this.car.getX()-this.startX),coins:this.coins,fuel:this.fuel};this.scene.start("CampScene",i)}addSky(){const t=this.add.graphics();t.fillGradientStyle(528934,794173,16171847,16768411,1),t.fillRect(0,0,this.scale.width,this.scale.height),t.setScrollFactor(0),t.setDepth(-10)}createStarfield(){const t=this.scale.width,i=this.scale.height;if(!this.textures.exists("starfield")){const s=this.add.graphics();s.fillStyle(16777215,.9);for(let a=0;a<120;a++){const o=c.Math.Between(0,t),g=c.Math.Between(0,i*.6),p=c.Math.FloatBetween(.8,2.4);s.fillCircle(o,g,p)}s.generateTexture("starfield",t,i),s.destroy()}this.stars=this.add.image(0,0,"starfield").setOrigin(0).setScrollFactor(0).setAlpha(0).setDepth(-11)}createSun(){this.sun=this.add.circle(140,120,60,16374134,.9),this.sun.setScrollFactor(.2),this.sun.setDepth(-5),this.duskOverlay=this.add.rectangle(0,0,this.scale.width,this.scale.height,592666,0).setOrigin(0).setScrollFactor(0).setDepth(40)}createPickupTextures(){if(!this.textures.exists("pickup-fuel")){const t=this.add.graphics();t.fillStyle(16739179,1),t.fillRoundedRect(0,0,34,44,6),t.fillStyle(16777215,1),t.fillTriangle(10,30,17,12,24,30),t.generateTexture("pickup-fuel",34,44),t.clear(),t.fillStyle(16761600,1),t.fillCircle(16,16,16),t.lineStyle(3,16777215,1),t.strokeCircle(16,16,16),t.generateTexture("pickup-coin",32,32),t.destroy()}}spawnPickups(){const t=this.terrain;for(let i=420;i<t.totalLength-100;i+=320){const s=w(t,i)-60,a=this.matter.add.sprite(i,s,"pickup-coin",void 0,{isStatic:!0,isSensor:!0,label:"pickup-coin"});a.setData("pickup","coin"),a.setDepth(2),this.tweens.add({targets:a,y:s-8,duration:1e3,yoyo:!0,repeat:-1,ease:"sine.inOut"}),this.pickups.push(a)}for(let i=700;i<t.totalLength-200;i+=520){const s=w(t,i)-70,a=this.matter.add.sprite(i,s,"pickup-fuel",void 0,{isStatic:!0,isSensor:!0,label:"pickup-fuel"});a.setData("pickup","fuel"),a.setDepth(2),this.tweens.add({targets:a,y:s-10,duration:1200,yoyo:!0,repeat:-1,ease:"sine.inOut"}),this.pickups.push(a)}}createParallax(){const t=this.scale.width,i=this.scale.height;if(!this.textures.exists("parallax-sky")){const p=this.add.graphics();p.fillGradientStyle(990523,990523,16042333,16242580,1),p.fillRect(0,0,t,i),p.generateTexture("parallax-sky",t,i),p.destroy();const r=this.add.graphics();r.fillStyle(13141065,1),r.beginPath(),r.moveTo(0,i*.75);for(let d=0;d<=t;d+=80){const y=i*.7+Math.sin(d*.01)*30+c.Math.Between(-10,20);r.lineTo(d,y)}r.lineTo(t,i),r.lineTo(0,i),r.closePath(),r.fillPath(),r.generateTexture("parallax-dune-far",t,i),r.clear(),r.fillStyle(11038525,1),r.beginPath(),r.moveTo(0,i*.78);for(let d=0;d<=t;d+=60){const y=i*.74+Math.sin(d*.013)*24+c.Math.Between(-18,18);r.lineTo(d,y)}r.lineTo(t,i),r.lineTo(0,i),r.closePath(),r.fillPath(),r.generateTexture("parallax-dune-mid",t,i),r.clear(),r.fillStyle(9196842,1),r.beginPath(),r.moveTo(0,i*.82);for(let d=0;d<=t;d+=50){const y=i*.8+Math.sin(d*.02)*20+c.Math.Between(-16,16);r.lineTo(d,y)}r.lineTo(t,i),r.lineTo(0,i),r.closePath(),r.fillPath(),r.generateTexture("parallax-dune-near",t,i),r.destroy()}const s=this.add.image(0,0,"parallax-sky").setOrigin(0).setScrollFactor(0).setDepth(-12),a=this.add.image(0,0,"parallax-dune-far").setOrigin(0).setScrollFactor(.12).setDepth(-9),o=this.add.image(0,0,"parallax-dune-mid").setOrigin(0).setScrollFactor(.18).setDepth(-8),g=this.add.image(0,0,"parallax-dune-near").setOrigin(0).setScrollFactor(.24).setDepth(-7);this.parallax=[s,a,o,g]}createDust(){var s;if(!this.textures.exists("dust")){const a=this.add.graphics();a.fillStyle(14596231,.9),a.fillCircle(8,8,8),a.generateTexture("dust",16,16),a.destroy()}const t=this.add.particles(0,0,"dust"),i=(s=t.emitters)!=null&&s.add?t.emitters.add.bind(t.emitters):t[["create","Emitter"].join("")].bind(t);this.dustEmitter=i({lifespan:600,speedX:{min:-80,max:40},speedY:{min:-10,max:-60},gravityY:200,scale:{start:.7,end:0},quantity:0,frequency:50,emitting:!0}),this.dustEmitter.startFollow(this.car.chassis,-30,30),t.setDepth(-2)}updateDust(){const t=this.car.getSpeed(),i=c.Math.Clamp(t/30,0,1.4);this.dustEmitter.setQuantity(i>.05?3:0),this.dustEmitter.speedX={min:-110-i*50,max:50},this.dustEmitter.followOffset.set(-30,30)}updateLighting(){const t=1-this.timeLeft/this.initialTime,i=c.Math.Easing.Sine.InOut(t),s=120+i*220,a=c.Display.Color.Interpolate.ColorWithColor(c.Display.Color.ValueToColor(16374134),c.Display.Color.ValueToColor(16735842),1,i),o=c.Display.Color.GetColor(a.r,a.g,a.b);this.sun.setY(s),this.sun.setFillStyle(o,.9),this.duskOverlay.setAlpha(.1+i*.65),this.stars.setAlpha(c.Math.Clamp((i-.4)*1.6,0,1))}captureCheckpoint(){const t=c.Math.RadToDeg(this.car.getTilt()),i=Math.abs(t)<30,s=this.car.getY()<w(this.terrain,this.car.getX())+140;i&&s&&this.car.getSpeed()>2&&this.car.getX()-this.checkpoint.x>250&&(this.checkpoint={x:this.car.getX(),y:this.car.getY()})}respawnAtCheckpoint(){const t=this.checkpoint.x,i=w(this.terrain,t)-90;[this.car.chassis,...this.car.wheels].forEach((a,o)=>{const g=o===0?0:o===1?-60:60;this.matter.body.setPosition(a.body,{x:t+g,y:i}),this.matter.body.setVelocity(a.body,{x:0,y:0}),this.matter.body.setAngularVelocity(a.body,0)})}}class z extends c.Scene{constructor(){super("CampScene")}create(e){var o;this.cameras.main.setBackgroundColor("#0c1024");const t=e.result==="win"?"VICTORY! Reached the ridge.":"Night fell. Try again!";this.add.text(this.scale.width/2,this.scale.height/2-60,t,{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5);const i=`Distance: ${e.distance.toFixed(0)} m
Coins: ${e.coins}
Fuel left: ${e.fuel.toFixed(0)}%`;this.add.text(this.scale.width/2,this.scale.height/2+10,i,{fontFamily:"monospace",fontSize:"20px",color:"#a0c7ff",align:"center"}).setOrigin(.5);const s=this.add.text(this.scale.width/2,this.scale.height/2+120,"Press SPACE / click to restart",{fontFamily:"monospace",fontSize:"18px",color:"#ffffff"}).setOrigin(.5);this.tweens.add({targets:s,alpha:.4,yoyo:!0,repeat:-1,duration:600});const a=()=>this.scene.start("HillClimbScene");(o=this.input.keyboard)==null||o.once("keydown-SPACE",a),this.input.on("pointerdown",a)}}const G=["service","Worker"].join(""),U=navigator,C=U[G];C!=null&&C.getRegistrations&&C.getRegistrations().then(l=>l.forEach(e=>e.unregister())).catch(()=>{});const b=window.caches;b!=null&&b.keys&&b.keys().then(l=>Promise.all(l.map(e=>b.delete(e)))).catch(()=>{});console.log("ARTPASS_FUN_V1");const $={type:c.AUTO,parent:"app",backgroundColor:"#0d1021",scale:{mode:c.Scale.FIT,autoCenter:c.Scale.CENTER_BOTH,width:1280,height:720},physics:{default:"matter",matter:{gravity:{x:0,y:1.25},debug:!1}},scene:[H,_,z]};new c.Game($);
