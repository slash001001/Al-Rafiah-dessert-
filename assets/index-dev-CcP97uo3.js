var L=Object.defineProperty;var O=(n,i,t)=>i in n?L(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var d=(n,i,t)=>O(n,typeof i!="symbol"?i+"":i,t);import{P as h}from"./vendor-0RJB29YE.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();class R extends h.Scene{constructor(){super("MenuScene")}create(){var e;this.createBackground(),this.add.text(this.scale.width/2,this.scale.height/2-80,"Hill-Climb Rally",{fontFamily:"monospace",fontSize:"48px",color:"#fefefe"}).setOrigin(.5),this.add.text(this.scale.width/2,this.scale.height/2,"Powered by Phaser 3 + Matter (yandeu ref)",{fontFamily:"monospace",fontSize:"18px",color:"#a0c7ff"}).setOrigin(.5);const i=this.add.text(this.scale.width/2,this.scale.height/2+80,"Press SPACE / click to start",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5);this.tweens.add({targets:i,alpha:.3,yoyo:!0,repeat:-1,duration:900});const t=()=>this.scene.start("HillClimbScene");(e=this.input.keyboard)==null||e.once("keydown-SPACE",t),this.input.on("pointerdown",t)}createBackground(){const i=this.add.graphics();i.fillGradientStyle(1056832,1254477,16234291,16227685,1),i.fillRect(0,0,this.scale.width,this.scale.height)}}class v{constructor(i){d(this,"text");d(this,"banner");d(this,"panel");d(this,"rightPanel");d(this,"rightText");this.scene=i,this.panel=i.add.rectangle(14,14,300,120,724766,.65).setOrigin(0).setStrokeStyle(2,16042333,.6).setScrollFactor(0).setDepth(50),this.text=i.add.text(26,22,"",{fontFamily:"monospace",fontSize:"18px",color:"#e9f2ff"}).setScrollFactor(0).setDepth(51),this.rightPanel=i.add.rectangle(i.scale.width-200,14,186,64,724766,.65).setOrigin(0).setStrokeStyle(2,16765286,.6).setScrollFactor(0).setDepth(50),this.rightText=i.add.text(i.scale.width-190,22,"",{fontFamily:"monospace",fontSize:"16px",color:"#ffdf9e"}).setScrollFactor(0).setDepth(51),this.banner=i.add.text(i.scale.width/2,20,"",{fontFamily:"monospace",fontSize:"20px",color:"#ffd166"}).setOrigin(.5,0).setScrollFactor(0).setDepth(51)}update(i){const t=Math.max(0,i.fuel),e=Math.max(0,i.distance),s=Math.max(0,i.timeLeft);this.text.setText(`Fuel: ${t.toFixed(0)}%
Distance: ${e.toFixed(0)} / ${i.target.toFixed(0)} m
Coins: ${i.coins}
Sunset: ${s.toFixed(1)}s`),this.rightText.setText(`ARTPASS_FUN_V1
PLAY: ◀ / ▶ or touch pedals`)}showBanner(i){this.banner.setText(i),this.banner.alpha=1,this.scene.tweens.add({targets:this.banner,alpha:.3,yoyo:!0,duration:500,repeat:-1})}}function B(n,i,t){E(n);const e=140,s=34,a=26,r=60,p=40,g=h.Physics.Matter.Matter,o=n.matter.add.image(i,t,"car-body",void 0,{label:"car-chassis"}),u=g.Bodies.rectangle(i,t,e,s,{chamfer:{radius:8}});o.setExistingBody(u),o.setFriction(.9).setFrictionAir(.02).setDensity(.0016);const y={friction:1,frictionStatic:1,frictionAir:.001,density:.0012,restitution:.05},c=n.matter.add.image(i-r,t+20,"car-wheel",void 0,{...y,label:"car-wheel"});c.setCircle(a);const l=n.matter.add.image(i+r,t+20,"car-wheel",void 0,{...y,label:"car-wheel"});l.setCircle(a),n.matter.add.constraint(o.body,c.body,p,.32,{pointA:{x:-r,y:10},pointB:{x:0,y:0}}),n.matter.add.constraint(o.body,c.body,p,.15,{pointA:{x:-r,y:-10},pointB:{x:0,y:0}}),n.matter.add.constraint(o.body,l.body,p,.32,{pointA:{x:r,y:10},pointB:{x:0,y:0}}),n.matter.add.constraint(o.body,l.body,p,.15,{pointA:{x:r,y:-10},pointB:{x:0,y:0}});const f=.55,m=.0018,T=x=>{const C=S()>28?.4:1,k=m*x*C;[c,l].forEach(F=>{if(!F.body)return;const M=F.body.angularVelocity+k,A=h.Math.Clamp(M,-f,f);g.Body.setAngularVelocity(F.body,A)})},S=()=>{const x=o.body.velocity;return Math.hypot(x.x,x.y)*60};return{chassis:o,wheels:[c,l],drive:T,getSpeed:S,getX:()=>o.x,getY:()=>o.y,getTilt:()=>o.rotation}}function E(n){if(n.textures.exists("car-body"))return;const i=n.add.graphics();i.fillStyle(3429585,1),i.fillRoundedRect(0,0,140,34,8),i.lineStyle(3,793165,.9),i.strokeRoundedRect(0,0,140,34,8),i.fillStyle(793165,.9),i.fillRoundedRect(16,4,50,18,6),i.generateTexture("car-body",140,34),i.clear(),i.fillStyle(2236962,1),i.fillCircle(30,30,30),i.lineStyle(4,15858414,1),i.strokeCircle(30,30,30),i.fillStyle(16777215,1),i.fillCircle(30,30,10),i.generateTexture("car-wheel",60,60),i.destroy()}function H(n,i){const{length:t,segmentLength:e,baseHeight:s,amplitude:a}=i,r=[],p=()=>h.Math.FloatBetween(-a*.35,a*.35);let g=s;for(let l=0;l<=t;l+=e){const f=Math.sin(l*.0015)*a*.6+Math.sin(l*7e-4)*a*.3;g=h.Math.Clamp(s+f+p(),s-a,s+a),r.push(new h.Math.Vector2(l,g))}const o=80,u=n.matter,y=h.Physics.Matter.Matter;for(let l=0;l<r.length-1;l++){const f=r[l],m=r[l+1],T=(f.x+m.x)/2,S=(f.y+m.y)/2,w=m.x-f.x,x=m.y-f.y,P=Math.sqrt(w*w+x*x),C=Math.atan2(x,w),k=y.Bodies.rectangle(T,S,P,o,{isStatic:!0,angle:C,friction:1,frictionStatic:1,restitution:0,label:"terrain"});u.world.add(k)}const c=n.add.graphics();return c.fillStyle(12683859,1),c.beginPath(),c.moveTo(0,n.scale.height+200),r.forEach(l=>c.lineTo(l.x,l.y)),c.lineTo(r[r.length-1].x,n.scale.height+200),c.closePath(),c.fillPath(),c.lineStyle(6,9263661,.9),c.beginPath(),c.moveTo(r[0].x,r[0].y-2),r.forEach(l=>c.lineTo(l.x,l.y-2)),c.strokePath(),c.setDepth(-1),n.matter.world.setBounds(0,0,t+800,n.scale.height+500,64,!0,!0,!0,!0),{points:r,totalLength:r[r.length-1].x}}function D(n,i){const t=n.points;if(i<=t[0].x)return t[0].y;if(i>=t[t.length-1].x)return t[t.length-1].y;for(let e=0;e<t.length-1;e++){const s=t[e],a=t[e+1];if(i>=s.x&&i<=a.x){const r=(i-s.x)/(a.x-s.x);return h.Math.Linear(s.y,a.y,r)}}return t[t.length-1].y}const z="ARTPASS_FUN_V1";class I extends h.Scene{constructor(){super("HillClimbScene");d(this,"car");d(this,"hud");d(this,"terrain");d(this,"keys");d(this,"fuel",100);d(this,"coins",0);d(this,"timeLeft",225);d(this,"initialTime",225);d(this,"targetDistance",1500);d(this,"startX",120);d(this,"ended",!1);d(this,"pickups",[]);d(this,"parallax",[]);d(this,"duskOverlay");d(this,"sun");d(this,"dustEmitter");d(this,"touchDir",0);d(this,"touchState",{left:!1,right:!1});d(this,"stars")}create(){var s;console.info(z),this.ended=!1,this.fuel=100,this.coins=0,this.timeLeft=this.initialTime,this.input.addPointer(2),this.addSky(),this.createStarfield(),this.createParallax(),this.createPickupTextures(),this.terrain=H(this,{length:2e3,segmentLength:70,baseHeight:this.scale.height*.7,amplitude:140}),this.spawnPickups();const t=D(this.terrain,this.startX)-90;this.car=B(this,this.startX,t);const e=this.cameras.main;e.setBackgroundColor("#0d1021"),e.startFollow(this.car.chassis,!0,.08,.08,-300,120),e.setBounds(0,0,this.terrain.totalLength+500,this.scale.height+200),this.createSun(),this.createDust(),this.hud=new v(this),this.hud.showBanner("Climb before sunset. Arrows / A-D or touch pedals. ARTPASS_FUN_V1"),this.hud.update({fuel:this.fuel,distance:0,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.keys=(s=this.input.keyboard)==null?void 0:s.addKeys({left:"LEFT",right:"RIGHT",a:"A",d:"D"}),this.matter.world.on("collisionstart",this.handleCollision,this),this.events.once(h.Scenes.Events.SHUTDOWN,()=>{this.matter.world.off("collisionstart",this.handleCollision,this)}),this.createTouchControls()}update(t,e){if(this.ended)return;const s=e/1e3,a=this.getInputDirection();a!==0&&this.fuel>0&&(this.car.drive(a),this.fuel=Math.max(0,this.fuel-9*s)),this.timeLeft=Math.max(0,this.timeLeft-s);const r=Math.max(0,this.car.getX()-this.startX);if(this.hud.update({fuel:this.fuel,distance:r,target:this.targetDistance,coins:this.coins,timeLeft:this.timeLeft}),this.timeLeft<=0)return this.endRun("fail");if(r>=this.targetDistance)return this.endRun("win");if(this.car.getY()>this.scale.height+600)return this.endRun("fail");const p=h.Math.RadToDeg(this.car.getTilt());if(Math.abs(p)>120&&this.car.getSpeed()<2)return this.endRun("fail");this.updateLighting(),this.updateDust()}getInputDirection(){var g,o,u,y,c,l,f,m;const t=((o=(g=this.keys)==null?void 0:g.left)==null?void 0:o.isDown)||((y=(u=this.keys)==null?void 0:u.a)==null?void 0:y.isDown),e=((l=(c=this.keys)==null?void 0:c.right)==null?void 0:l.isDown)||((m=(f=this.keys)==null?void 0:f.d)==null?void 0:m.isDown),s=this.touchState.left,a=this.touchState.right,r=t||s,p=e||a;return r&&!p?-1:p&&!r?1:0}handleCollision(t){for(const e of t.pairs)this.tryPickup(e.bodyA,e.bodyB),this.tryPickup(e.bodyB,e.bodyA)}tryPickup(t,e){const s=t.gameObject,a=s==null?void 0:s.getData("pickup");a&&s&&this.isCarBody(e)&&(a==="fuel"&&this.collectFuel(s),a==="coin"&&this.collectCoin(s))}collectFuel(t){this.fuel=Math.min(100,this.fuel+45),this.fadePickup(t)}collectCoin(t){this.coins+=1,this.fadePickup(t)}fadePickup(t){t.body&&this.matter.world.remove(t.body),this.tweens.add({targets:t,alpha:0,scale:1.4,duration:250,onComplete:()=>t.destroy()})}isCarBody(t){return t?t.label==="car-chassis"||t.label==="car-wheel":!1}endRun(t){if(this.ended)return;this.ended=!0;const e={result:t,distance:Math.max(0,this.car.getX()-this.startX),coins:this.coins,fuel:this.fuel};this.scene.start("CampScene",e)}addSky(){const t=this.add.graphics();t.fillGradientStyle(528934,794173,16171847,16768411,1),t.fillRect(0,0,this.scale.width,this.scale.height),t.setScrollFactor(0),t.setDepth(-10)}createStarfield(){const t=this.scale.width,e=this.scale.height;if(!this.textures.exists("starfield")){const s=this.add.graphics();s.fillStyle(16777215,.9);for(let a=0;a<120;a++){const r=h.Math.Between(0,t),p=h.Math.Between(0,e*.6),g=h.Math.FloatBetween(.8,2.4);s.fillCircle(r,p,g)}s.generateTexture("starfield",t,e),s.destroy()}this.stars=this.add.image(0,0,"starfield").setOrigin(0).setScrollFactor(0).setAlpha(0).setDepth(-11)}createSun(){this.sun=this.add.circle(140,120,60,16374134,.9),this.sun.setScrollFactor(.2),this.sun.setDepth(-5),this.duskOverlay=this.add.rectangle(0,0,this.scale.width,this.scale.height,592666,0).setOrigin(0).setScrollFactor(0).setDepth(40)}createPickupTextures(){if(!this.textures.exists("pickup-fuel")){const t=this.add.graphics();t.fillStyle(16739179,1),t.fillRoundedRect(0,0,34,44,6),t.fillStyle(16777215,1),t.fillTriangle(10,30,17,12,24,30),t.generateTexture("pickup-fuel",34,44),t.clear(),t.fillStyle(16761600,1),t.fillCircle(16,16,16),t.lineStyle(3,16777215,1),t.strokeCircle(16,16,16),t.generateTexture("pickup-coin",32,32),t.destroy()}}spawnPickups(){const t=this.terrain;for(let e=420;e<t.totalLength-100;e+=320){const s=D(t,e)-60,a=this.matter.add.sprite(e,s,"pickup-coin",void 0,{isStatic:!0,isSensor:!0,label:"pickup-coin"});a.setData("pickup","coin"),a.setDepth(2),this.pickups.push(a)}for(let e=700;e<t.totalLength-200;e+=520){const s=D(t,e)-70,a=this.matter.add.sprite(e,s,"pickup-fuel",void 0,{isStatic:!0,isSensor:!0,label:"pickup-fuel"});a.setData("pickup","fuel"),a.setDepth(2),this.pickups.push(a)}}createParallax(){const t=this.scale.width,e=this.scale.height;if(!this.textures.exists("parallax-sky")){const g=this.add.graphics();g.fillGradientStyle(990523,990523,16042333,16242580,1),g.fillRect(0,0,t,e),g.generateTexture("parallax-sky",t,e),g.destroy();const o=this.add.graphics();o.fillStyle(13141065,1),o.beginPath(),o.moveTo(0,e*.75);for(let u=0;u<=t;u+=80){const y=e*.7+Math.sin(u*.01)*30+h.Math.Between(-10,20);o.lineTo(u,y)}o.lineTo(t,e),o.lineTo(0,e),o.closePath(),o.fillPath(),o.generateTexture("parallax-dune-far",t,e),o.clear(),o.fillStyle(11038525,1),o.beginPath(),o.moveTo(0,e*.78);for(let u=0;u<=t;u+=60){const y=e*.74+Math.sin(u*.013)*24+h.Math.Between(-18,18);o.lineTo(u,y)}o.lineTo(t,e),o.lineTo(0,e),o.closePath(),o.fillPath(),o.generateTexture("parallax-dune-mid",t,e),o.clear(),o.fillStyle(9196842,1),o.beginPath(),o.moveTo(0,e*.82);for(let u=0;u<=t;u+=50){const y=e*.8+Math.sin(u*.02)*20+h.Math.Between(-16,16);o.lineTo(u,y)}o.lineTo(t,e),o.lineTo(0,e),o.closePath(),o.fillPath(),o.generateTexture("parallax-dune-near",t,e),o.destroy()}const s=this.add.image(0,0,"parallax-sky").setOrigin(0).setScrollFactor(0).setDepth(-12),a=this.add.image(0,0,"parallax-dune-far").setOrigin(0).setScrollFactor(.12).setDepth(-9),r=this.add.image(0,0,"parallax-dune-mid").setOrigin(0).setScrollFactor(.18).setDepth(-8),p=this.add.image(0,0,"parallax-dune-near").setOrigin(0).setScrollFactor(.24).setDepth(-7);this.parallax=[s,a,r,p]}createDust(){var s;if(!this.textures.exists("dust")){const a=this.add.graphics();a.fillStyle(14596231,.9),a.fillCircle(8,8,8),a.generateTexture("dust",16,16),a.destroy()}const t=this.add.particles(0,0,"dust"),e=(s=t.emitters)!=null&&s.add?t.emitters.add.bind(t.emitters):t[["create","Emitter"].join("")].bind(t);this.dustEmitter=e({lifespan:600,speedX:{min:-80,max:40},speedY:{min:-10,max:-60},gravityY:200,scale:{start:.7,end:0},quantity:0,frequency:50,emitting:!0}),this.dustEmitter.startFollow(this.car.chassis,-30,30),t.setDepth(-2)}updateDust(){const t=this.car.getSpeed(),e=h.Math.Clamp(t/30,0,1.4);this.dustEmitter.setQuantity(e>.05?3:0),this.dustEmitter.speedX={min:-110-e*50,max:50},this.dustEmitter.followOffset.set(-30,30)}updateLighting(){const t=1-this.timeLeft/this.initialTime,e=h.Math.Easing.Sine.InOut(t),s=120+e*220,a=h.Display.Color.Interpolate.ColorWithColor(h.Display.Color.ValueToColor(16374134),h.Display.Color.ValueToColor(16735842),1,e),r=h.Display.Color.GetColor(a.r,a.g,a.b);this.sun.setY(s),this.sun.setFillStyle(r,.9),this.duskOverlay.setAlpha(.1+e*.65),this.stars.setAlpha(h.Math.Clamp((e-.4)*1.6,0,1))}createTouchControls(){const a=this.scale.height-75-26,r=this.add.rectangle(150/2+26,a,150,150,0,.2).setScrollFactor(0).setDepth(30),p=this.add.rectangle(this.scale.width-150/2-26,a,150,150,0,.2).setScrollFactor(0).setDepth(30);r.setStrokeStyle(3,16042333,.8),p.setStrokeStyle(3,16042333,.8);const g=this.add.text(r.x,r.y,"◀",{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5).setScrollFactor(0).setDepth(31),o=this.add.text(p.x,p.y,"▶",{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5).setScrollFactor(0).setDepth(31),u=f=>{this.touchState.left=f,r.setAlpha(f?.4:.2)},y=f=>{this.touchState.right=f,p.setAlpha(f?.4:.2)},c={down:()=>u(!0),up:()=>u(!1)},l={down:()=>y(!0),up:()=>y(!1)};r.setInteractive({useHandCursor:!0}).on("pointerdown",c.down).on("pointerup",c.up).on("pointerout",c.up).on("pointerupoutside",c.up),p.setInteractive({useHandCursor:!0}).on("pointerdown",l.down).on("pointerup",l.up).on("pointerout",l.up).on("pointerupoutside",l.up),g.setInteractive({useHandCursor:!0}).on("pointerdown",c.down).on("pointerup",c.up).on("pointerout",c.up),o.setInteractive({useHandCursor:!0}).on("pointerdown",l.down).on("pointerup",l.up).on("pointerout",l.up)}}class X extends h.Scene{constructor(){super("CampScene")}create(i){var r;this.cameras.main.setBackgroundColor("#0c1024");const t=i.result==="win"?"VICTORY! Reached the ridge.":"Night fell. Try again!";this.add.text(this.scale.width/2,this.scale.height/2-60,t,{fontFamily:"monospace",fontSize:"36px",color:"#ffd166"}).setOrigin(.5);const e=`Distance: ${i.distance.toFixed(0)} m
Coins: ${i.coins}
Fuel left: ${i.fuel.toFixed(0)}%`;this.add.text(this.scale.width/2,this.scale.height/2+10,e,{fontFamily:"monospace",fontSize:"20px",color:"#a0c7ff",align:"center"}).setOrigin(.5);const s=this.add.text(this.scale.width/2,this.scale.height/2+120,"Press SPACE / click to restart",{fontFamily:"monospace",fontSize:"18px",color:"#ffffff"}).setOrigin(.5);this.tweens.add({targets:s,alpha:.4,yoyo:!0,repeat:-1,duration:600});const a=()=>this.scene.start("HillClimbScene");(r=this.input.keyboard)==null||r.once("keydown-SPACE",a),this.input.on("pointerdown",a)}}const Y={type:h.AUTO,parent:"app",backgroundColor:"#0d1021",scale:{mode:h.Scale.FIT,autoCenter:h.Scale.CENTER_BOTH,width:1280,height:720},physics:{default:"matter",matter:{gravity:{x:0,y:1.25},debug:!1}},scene:[R,I,X]},N=["service","Worker",`${Date.now()}`].slice(0,2).join(""),V=navigator,b=V[N];b!=null&&b.getRegistrations&&b.getRegistrations().then(n=>n.forEach(i=>i.unregister())).catch(()=>{});new h.Game(Y);
