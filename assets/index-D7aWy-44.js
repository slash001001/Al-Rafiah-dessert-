var C=Object.defineProperty;var T=(l,h,t)=>h in l?C(l,h,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[h]=t;var o=(l,h,t)=>T(l,typeof h!="symbol"?h+"":h,t);import{P as a}from"./phaser-0RJB29YE.js";(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();class M extends a.Scene{constructor(){super("MenuScene");o(this,"selected","gmc")}create(){var n,d;const{width:t,height:e}=this.scale;this.cameras.main.setBackgroundColor(724756),this.cameras.main.fadeIn(200,0,0,0),this.add.text(t/2,e/2-140,"Ø§Ù„Ø±Ø§ÙØ¹ÙŠØ©",{fontSize:"52px",fontFamily:"system-ui, sans-serif",color:"#f4c27a"}).setOrigin(.5),this.add.text(t/2,e/2-70,"Ø·Ù„Ø¹Ø© Ø¨Ø± â€“ Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø£ØºØ±Ø§Ø¶ Ù‚Ø¨Ù„ ØªØºÙŠØ¨ Ø§Ù„Ø´Ù…Ø³",{fontSize:"18px",fontFamily:"system-ui, sans-serif",color:"#e0e7ff"}).setOrigin(.5);const s=this.button(t/2-140,e/2+20,"GMC (Ø£Ø³ÙˆØ¯)",()=>this.pick("gmc")),i=this.button(t/2+140,e/2+20,"Prado (Ø¨Ù†ÙŠ)",()=>this.pick("prado")),r=this.button(t/2,e/2+110,"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©",()=>this.startRun(),32);this.pick("gmc"),(n=this.input.keyboard)==null||n.on("keydown-ENTER",()=>r.emit("pointerdown")),(d=this.input.keyboard)==null||d.on("keydown-SPACE",()=>r.emit("pointerdown")),s.on("pointerdown",()=>this.pick("gmc")),i.on("pointerdown",()=>this.pick("prado"))}button(t,e,s,i,r=26){const n=this.add.text(t,e,s,{fontSize:`${r}px`,fontFamily:"system-ui, sans-serif",color:"#ffffff",backgroundColor:"#2e86ab",padding:{x:14,y:10}}).setOrigin(.5).setInteractive({useHandCursor:!0});return n.on("pointerdown",i),n.on("pointerover",()=>n.setScale(1.05)),n.on("pointerout",()=>n.setScale(1)),n}pick(t){this.selected=t}startRun(){this.cameras.main.fadeOut(200,0,0,0),this.cameras.main.once(a.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,()=>{this.scene.start("RunScene",{vehicle:this.selected})})}}class F extends a.Scene{constructor(){super("RunScene");o(this,"vehicle","gmc");o(this,"player");o(this,"shadow");o(this,"cursors");o(this,"keys");o(this,"fuel",100);o(this,"nitro",{active:!1,timer:0,cooldown:0});o(this,"items",[]);o(this,"collected",new Set);o(this,"hud",{});o(this,"timerTotal",210);o(this,"timer",this.timerTotal);o(this,"finishX",3200);o(this,"chaosQueue",[]);o(this,"chaosCooldown",12);o(this,"chaosTimer",6);o(this,"statusText");o(this,"trailTimer",0)}preload(){this.makeTextures()}makeTextures(){const t=this.add.graphics();t.fillStyle(this.vehicle==="prado"?9132587:1118481,1),t.fillRoundedRect(0,0,56,30,6),t.fillStyle(16777215,.6),t.fillRect(6,6,18,10),t.fillRect(32,6,18,10),t.generateTexture("car-body",56,30),t.clear(),t.fillStyle(0,.25),t.fillEllipse(28,16,60,20),t.generateTexture("car-shadow",60,24),t.clear(),t.fillStyle(8149818,1),t.fillCircle(0,0,12),t.generateTexture("rock",24,24),t.clear(),t.fillStyle(16777215,1),t.fillCircle(5,5,5),t.generateTexture("puff",10,10),t.clear(),t.fillStyle(16040570,1),t.fillRect(0,0,140,16),t.fillStyle(1118481,1);for(let e=0;e<14;e+=1)e%2===0&&t.fillRect(e*10,0,10,16);t.generateTexture("finish",140,16),t.clear(),t.fillStyle(15914918,1),t.fillRect(0,0,64,64),t.lineStyle(2,15320978,.4);for(let e=0;e<10;e+=1)t.strokeCircle(a.Math.Between(0,64),a.Math.Between(0,64),a.Math.Between(1,3));t.generateTexture("sand-tex",64,64),t.clear(),t.lineStyle(3,14992526,.6);for(let e=0;e<256;e+=12){const s=60+Math.sin(e*.12)*10;t.lineBetween(e,s,e+12,60+Math.sin((e+12)*.12)*10)}t.generateTexture("ridge",256,128),t.destroy()}create(t){this.vehicle=(t==null?void 0:t.vehicle)??"gmc",this.makeTextures(),this.timer=this.timerTotal,this.fuel=100,this.collected.clear(),this.chaosQueue=["stuck","overheat","flat","rain","helicopter","camel","dogs"].sort(()=>Math.random()-.5),this.chaosCooldown=10,this.chaosTimer=8,this.trailTimer=0;const{width:e,height:s}=this.scale;this.cameras.main.setBackgroundColor(724756),this.cameras.main.fadeIn(180,0,0,0),this.add.tileSprite(0,0,e,s,"ridge").setOrigin(0,0).setScrollFactor(.1).setAlpha(.35),this.add.tileSprite(0,s*.55,e,s*.45,"sand-tex").setOrigin(0,0).setScrollFactor(.2),this.player=this.physics.add.sprite(160,s/2,"car-body"),this.shadow=this.add.image(this.player.x,this.player.y+12,"car-shadow"),this.shadow.setDepth(-1),this.physics.world.setBounds(0,0,3600,s),this.player.setCollideWorldBounds(!0),this.cameras.main.startFollow(this.player,!0,.12,.12),this.cameras.main.setDeadzone(220,140),this.cameras.main.setFollowOffset(0,-30),this.cursors=this.input.keyboard.createCursorKeys(),this.keys=this.input.keyboard.addKeys("W,A,S,D,SPACE,ESC"),this.spawnStops(),this.spawnItems(),this.spawnRocks(),this.makeFinish(),this.makeHUD(),this.statusText=this.add.text(e/2,60,"",{fontSize:"20px",fontFamily:"system-ui, sans-serif",color:"#ffffff",backgroundColor:"rgba(0,0,0,0.35)",padding:{x:10,y:6}}).setOrigin(.5).setScrollFactor(0)}spawnStops(){[{x:400,label:"Ù…Ø­Ø·Ø©",action:()=>{this.fuel=100,this.toast("ÙÙ„Ù„Ù†Ø§ Ø¨Ù†Ø²ÙŠÙ†")}},{x:800,label:"Ù…Ø·Ø¹Ù…",action:()=>this.toast("Ø´Ø§ÙˆØ±Ù…Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±ÙŠØ¹")},{x:1100,label:"Ø¨Ù‚Ø§Ù„Ø©",action:()=>this.collectRandom()}].forEach(e=>{const s=this.add.rectangle(e.x,this.scale.height/2,120,120,3049131,.4).setStrokeStyle(3,16777215,.8);this.physics.add.existing(s,!0),this.physics.add.overlap(this.player,s,()=>e.action(),void 0,this),this.add.text(e.x,this.scale.height/2-80,e.label,{fontSize:"16px",fontFamily:"system-ui, sans-serif",color:"#ffffff",backgroundColor:"rgba(0,0,0,0.45)",padding:{x:6,y:4}}).setOrigin(.5)})}collectRandom(){const t=["salt","water","charcoal","lighter","hummus"],e=t[Math.floor(Math.random()*t.length)];this.collected.has(e)?this.toast("Ù…Ø§ Ù„Ù‚ÙŠÙ†Ø§ Ø´ÙŠ Ø¬Ø¯ÙŠØ¯"):(this.collected.add(e),this.toast(`Ù„Ù‚ÙŠÙ†Ø§ ${e}`))}spawnItems(){const t=[{key:"salt",label:"Ù…Ù„Ø­",color:14472951},{key:"water",label:"Ù…ÙˆÙŠÙ‡",color:8374520},{key:"charcoal",label:"ÙØ­Ù…",color:2829099},{key:"lighter",label:"ÙˆÙ„Ø§Ø¹Ø©",color:16762967},{key:"hummus",label:"Ø­Ù…Øµ",color:16773810}],e=2200;this.items=t.map((s,i)=>({...s,x:1400+i*(e/t.length)+a.Math.Between(-40,40),y:a.Math.Between(180,this.scale.height-180)})),this.items.forEach(s=>{const i=this.add.rectangle(s.x,s.y,28,20,s.color).setStrokeStyle(2,1118481);this.physics.add.existing(i,!0),this.physics.add.overlap(this.player,i,()=>{this.collected.has(s.key)||(this.collected.add(s.key),i.destroy(),this.toast(`Ø£Ø®Ø°Øª ${s.label}`))})})}spawnRocks(){for(let t=0;t<8;t+=1){const e=a.Math.Between(1200,3200),s=a.Math.Between(180,this.scale.height-180),i=this.physics.add.staticImage(e,s,"rock");i.body.setCircle(12),this.physics.add.overlap(this.player,i,()=>this.hitRock(),void 0,this)}}makeFinish(){const t=this.scale.height/2,e=this.physics.add.staticImage(this.finishX,t,"finish");e.body.setSize(140,2e3),this.physics.add.overlap(this.player,e,()=>this.win(),void 0,this)}makeHUD(){const t=this.add.graphics().setScrollFactor(0);t.fillStyle(724756,.75),t.fillRoundedRect(12,12,340,120,12);const e={fontSize:"18px",fontFamily:"system-ui, sans-serif",color:"#e8f1ff"};this.hud.speed=this.add.text(20,20,"Speed: 0",e).setScrollFactor(0),this.hud.fuel=this.add.text(20,44,"Fuel: 100%",e).setScrollFactor(0),this.hud.timer=this.add.text(20,68,"Time: 0",e).setScrollFactor(0),this.hud.items=this.add.text(20,92,"Items: 0/5",e).setScrollFactor(0),this.hud.timeLeft=this.add.text(this.scale.width-16,20,"",e).setOrigin(1,0).setScrollFactor(0)}update(t,e){if(!this.player)return;const s=e/1e3;if(this.timer-=s,this.timer<=0)return this.fail();this.handleInput(s),this.updateHUD(),this.updateTrail(s),this.handleChaos(s),this.shadow.setPosition(this.player.x,this.player.y+12)}handleInput(t){const e=this.player.body,s=this.cursors.up.isDown||this.keys.W.isDown,i=this.cursors.down.isDown||this.keys.S.isDown,r=this.cursors.left.isDown||this.keys.A.isDown,n=this.cursors.right.isDown||this.keys.D.isDown,d=this.keys.SPACE.isDown;this.nitro.cooldown>0&&(this.nitro.cooldown-=t),this.nitro.active?(this.nitro.timer-=t,this.nitro.timer<=0&&(this.nitro.active=!1,this.nitro.cooldown=3)):d&&this.nitro.cooldown<=0&&this.fuel>5&&(this.nitro.active=!0,this.nitro.timer=1,this.toast("Ù†ÙŠØªØ±Ùˆ!"));const c=s?170:0,f=i?220:0,y=this.nitro.active?300:0,g=s?6*t:1.5*t;this.fuel=Math.max(0,this.fuel-g-(this.nitro.active?8*t:0));const m=.9,w=this.fuel<=0?220:420,x=(r?-1:0)+(n?1:0),p=e.velocity.length(),b=a.Math.Clamp(p/w,0,1),k=(c+y-f-m*p)*Math.cos(this.player.rotation),v=(c+y-f-m*p)*Math.sin(this.player.rotation);e.velocity.x+=k*t,e.velocity.y+=v*t,e.velocity.length()>w&&e.velocity.setLength(w),Math.abs(x)>.1&&p>10&&(this.player.rotation+=x*(2.6+2*b)*t),this.cameras.main.setFollowOffset(0,-30+Math.sin(this.time.now*.003)*8)}updateTrail(t){const e=this.player.body;if(this.trailTimer-=t,this.trailTimer<=0&&e.velocity.length()>40){this.trailTimer=.05;const s=new a.Math.Vector2(-20,6).rotate(this.player.rotation),i=this.add.image(this.player.x+s.x,this.player.y+s.y,"puff").setScale(a.Math.FloatBetween(.8,1.2)).setAlpha(.7);this.tweens.add({targets:i,alpha:0,scale:i.scale*1.8,duration:320,ease:"Sine.easeOut",onComplete:()=>i.destroy()})}}updateHUD(){var i,r,n,d,c;const t=this.player.body,e=Math.round(t.velocity.length()),s=Math.max(0,this.finishX-this.player.x);(i=this.hud.speed)==null||i.setText(`Speed: ${e}`),(r=this.hud.fuel)==null||r.setText(`Fuel: ${Math.round(this.fuel)}%`),(n=this.hud.timer)==null||n.setText(`Time: ${this.timer.toFixed(1)}s`),(d=this.hud.items)==null||d.setText(`Items: ${this.collected.size}/5`),(c=this.hud.timeLeft)==null||c.setText(`Finish Dist: ${s.toFixed(0)}m`)}handleChaos(t){var i;const e=this.player.body;if(this.chaosTimer-=t,this.chaosTimer>0||this.chaosQueue.length===0)return;switch(this.chaosTimer=this.chaosCooldown,this.chaosCooldown=Math.max(6,this.chaosCooldown-1),this.chaosQueue.shift()){case"stuck":this.toast("Ø¹Ù„Ù‚Ù†Ø§ Ø¨Ø§Ù„Ø±Ù…Ù„!"),e.velocity.scale(.4);break;case"overheat":this.toast("Ø§Ù„Ù…ÙˆØªØ± Ø­Ø§Ø±ØŒ Ø®Ù!"),e.velocity.scale(.6);break;case"flat":this.toast("ÙƒÙØ± Ù…Ù‡Ø¨Ø·ØŒ Ø§Ù„Ø³Ø±Ø¹Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©"),(i=e.setMaxSpeed)==null||i.call(e,240);break;case"rain":this.toast("Ù…Ø·Ø± Ø®ÙÙŠÙØŒ Ø§Ù…Ø³Ùƒ Ø§Ù„Ø®Ø·"),e.velocity.scale(.7);break;case"helicopter":this.toast("ØªØ¯Ø±ÙŠØ¨ Ù‡Ù„ÙŠÙƒÙˆØ¨ØªØ± ÙÙˆÙ‚Ù†Ø§!"),this.cameras.main.shake(150,.003);break;case"camel":this.toast("Ø¬Ù…Ù„ ÙŠÙ‚Ø·Ø¹ Ø§Ù„Ø·Ø±ÙŠÙ‚!"),e.velocity.scale(.5);break;case"dogs":this.toast("ÙƒÙ„Ø§Ø¨ Ø¶Ø§ÙŠØ¹Ù‡ØŒ Ø¨ÙˆÙ‚ ÙˆØªÙÙƒÙ†Ø§"),e.velocity.scale(.7);break}}toast(t){var e;(e=this.statusText)==null||e.setText(t),this.tweens.add({targets:this.statusText,alpha:{from:1,to:0},duration:800,onComplete:()=>{var s;return(s=this.statusText)==null?void 0:s.setAlpha(1)}})}hitRock(){this.player.body.velocity.scale(.5),this.cameras.main.shake(150,.004),this.toast("Ø­Ø¬Ø± ÙŠÙˆÙ‚ÙÙ†Ø§ Ø´ÙˆÙŠ")}win(){this.cameras.main.fadeOut(220,0,0,0,()=>{this.scene.start("CampScene",{win:!0,items:Array.from(this.collected),vehicle:this.vehicle})})}fail(){this.scene.start("CampScene",{win:!1,items:Array.from(this.collected),vehicle:this.vehicle})}}class O extends a.Scene{constructor(){super("CampScene");o(this,"win",!1);o(this,"items",[]);o(this,"vehicle","gmc")}init(t){this.win=(t==null?void 0:t.win)??!1,this.items=(t==null?void 0:t.items)??[],this.vehicle=(t==null?void 0:t.vehicle)??"gmc"}create(){const{width:t,height:e}=this.scale;this.cameras.main.setBackgroundColor(724756),this.cameras.main.fadeIn(180,0,0,0);const s=this.add.text(t/2,e/2-120,this.win?"ÙˆØµÙ„Ù†Ø§ Ø§Ù„Ù…Ø®ÙŠÙ… ðŸ”¥":"ØºØ§Ø¨Øª Ø§Ù„Ø´Ù…Ø³ Ù‚Ø¨Ù„ Ù„Ø§ Ù†ÙˆØµÙ„",{fontSize:"36px",fontFamily:"system-ui, sans-serif",color:this.win?"#f4c27a":"#ffaaaa"}).setOrigin(.5),i=["salt","water","charcoal","lighter"],r=i.filter(f=>!this.items.includes(f)),n=this.items.filter(f=>!i.includes(f));this.add.text(t/2,e/2-50,`Ø§Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: ${i.length-r.length}/${i.length}`,{fontSize:"20px",fontFamily:"system-ui, sans-serif",color:"#e8f1ff"}).setOrigin(.5),this.add.text(t/2,e/2-10,r.length?`Ù†Ø§Ù‚Øµ: ${r.join(", ")}`:"ÙƒØ§Ù…Ù„ÙŠÙ† Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡",{fontSize:"18px",fontFamily:"system-ui, sans-serif",color:"#cdd7ff"}).setOrigin(.5);const d=this.randomLine(r,n);this.add.text(t/2,e/2+30,d,{fontSize:"18px",fontFamily:"system-ui, sans-serif",color:"#ffffff"}).setOrigin(.5);const c=this.add.text(t/2,e/2+110,"â†» Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©",{fontSize:"24px",fontFamily:"system-ui, sans-serif",color:"#ffffff",backgroundColor:"#2e86ab",padding:{x:14,y:10}}).setOrigin(.5).setInteractive({useHandCursor:!0});if(c.on("pointerdown",()=>this.scene.start("MenuScene")),c.on("pointerover",()=>c.setScale(1.05)),c.on("pointerout",()=>c.setScale(1)),this.win)for(let f=0;f<15;f+=1){const y=a.Math.Between(-140,140),g=a.Math.Between(-20,40),m=this.add.circle(s.x+y,s.y+g,a.Math.Between(2,4),16040570,.9);this.tweens.add({targets:m,alpha:0,scale:1.8,duration:a.Math.Between(300,600),ease:"Sine.easeOut",delay:a.Math.Between(0,200),onComplete:()=>m.destroy()})}}randomLine(t,e){return Math.random()<.03?"Ø¹Ù„ÙŠ Ù…Ø´Ø§Ø±ÙŠ ÙŠÙ‚ÙˆÙ„: Ù„Ùˆ Ø³Ø£Ù„Ù†Ø§ Ø¹Ù† Ø§Ù„Ù…Ù„Ø­ ÙƒØ§Ù† Ø£Ø­Ø³Ù† ðŸ˜…":t.length===0?"Ø§Ù„Ø·Ø¨Ø®Ø© Ù†Ø¬Ø­Øª Ø¨Ø§Ù„ØµØ¯ÙØ©ØŒ Ø­ØªÙ‰ Ù…Ø¹ Ø­Ø±ÙƒØ§ØªÙƒÙ…":t.length>=3?"Ø§Ù„Ù…Ø´ÙˆÙŠ Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø­ ÙˆÙ…ÙˆÙŠÙ‡ØŸ Ø²Ø¹Ù„Øª Ø§Ù„ÙƒØ´ØªÙ‡ ÙƒÙ„Ù‡Ø§":t.includes("salt")?"Ù…ÙŠÙ† Ø·Ù„Ø¹ Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø­ØŸ Ø§Ù„Ø³ÙŠØ±Ùƒ ÙƒØ§Ù…Ù„ Ø­Ø§Ø¶Ø±":t.includes("water")?"Ù…ÙˆÙŠÙ‡ Ù…Ø§ÙÙŠØŒ Ø¨Ø³ Ø¹Ù†Ø¯Ù†Ø§ Ø­Ù…Ø§Ø³.":e.includes("hummus")?"Ø­Ù…Øµ Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø¨Ø³ Ø§Ù„ÙØ­Ù… ÙˆÙŠÙ†Ù‡ØŸ":"Ø­Ø§ÙˆÙ„Ù†Ø§ Ù†Ø¶Ø¨Ø·Ù‡Ø§ØŒ Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ù‚Ø§Ø¨Ù„ÙŠÙ† Ù„Ù„Ø£ÙƒÙ„ Ø¨Ø§Ù„ÙƒØ§Ø¯."}}const R={bg:724756},u=document.getElementById("error-overlay");u&&(u.textContent="Loading Rafiahâ€¦",u.style.display="block");function S(l){u&&(u.textContent=l,u.style.display="block")}window.addEventListener("error",l=>S(`window.error: ${l.message}`));window.addEventListener("unhandledrejection",l=>S(`unhandled: ${String(l.reason)}`));new a.Game({type:a.AUTO,backgroundColor:R.bg,parent:"app",scale:{mode:a.Scale.FIT,autoCenter:a.Scale.CENTER_BOTH,width:960,height:540},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[M,F,O]});u&&(u.textContent="",u.style.display="none");
